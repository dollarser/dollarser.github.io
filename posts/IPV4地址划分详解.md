---
title: IPV4地址划分详解
date: 2020-01-17 20:04:43
tags:
 - 计网
typora-root-url: ..
typora-copy-images-to: ..\img
---

1\.  概述：
-----------

早期网络分配是只能以网段为单位进行(可能是出于路由简单的目的，网段类似电话号区号)。类比到电话4位区号，7位座机号，共11位。当电话呼叫时，线路进行转接的时候只需看区号就可以直接把电话接到某个地区，地区再看座机号接到具体某一户。这样一来转接过程各自分工让电话接通变得更加简单。网络通信也是类似，ip地址总共32位（二进制），但是网络号（区号）和主机号（座机号）不像11位电话那样始终固定为4位7位。

ip的划分稍微复杂一点，其划分原则为：ip地址中若第一位为0，则网络号8位，主机号24位，被称为A类地址。若第一位为1第二位为0，则网络号16位，主机号16位，被称为B类地址。若第一二位为1第三位为0，则网络号24位，主机号8位，被称为C类地址。早期网络并非个人使用，而是科研机构军工学校企业等使用，故ip的分配也是以网络号为单位，而不是以单个ip为单位来售卖。类比到电话就是，直接区号分配给你，而不是分配手机号。机构的用户多就购买一个A类网段，约可以连16M(2^24，主机号24位)台电脑，人少就购买B类网段，约可以连64k(2^16)台电脑，更少则购买C类网段，约可以连256(2^8)台电脑。分配到网段后，该网端的ip供机构自由分配给机构内的电脑，且网络运营商只负责将发往该网段的数据转发给该机构。至于该数据是属于哪台主机，由机构自己负责路由。

<!--more-->

----

2\. 网络划分细节：
------------------------

**1\.  A类地址：**

1.0.0.0－126.255.255.255
(**0**0000001 00000000 00000000 00000000 ~ **0**1111110 11111111 11111111 11111111）

ip地址第一位为0，前8位为网络号，标识网段，后24位为主机号，标识主机。
这里可以看到ip地址第一位为0的网段中，A类地址缺少了两个网段，这两个网段分别是：
(1) 0.0.0.0－0.255.255.255，即 
(**0**0000000 00000000 00000000 00000000 ~ **0**0000000 11111111 11111111 11111111)
该网段前八位网络号全0表示本网络。其中后24位主机号全0的ip表示本主机。所以0.0.0.0表示本网络上的本主机，也就是指本机自己，一般用于路由器指定默认路由端口。网络号(前八位)全0的其他地址似乎没有用处，按道理应该指本网络的其他主机，但实测并非如此。

(2) 127.0.0.0－127.255.255.255，即
(**0**1111111 00000000 00000000 00000000 ~ **0**1111111 11111111 11111111 11111111)
127网络为保留地址，作为环路自检地址，也就是指本机自身，一般用于测试tcp/ip工作栈是否正常。目的地址以127开头的环回地址不会出现在网络上，只能在主机内部，人话也就是只能自己发给自己，用于测试自身软硬件配置是否正常。

另外A类地址中还有一段私有地址和一段保留地址：
  （1）A类私有地址(同时也是保留地址)：
    10.0.0.0－10.255.255.255

  （2）A类保留地址：
    100.64.0.0－100.127.255.255

关于私有地址和保留地址下面会详细介绍, ABC各类地址都会留一段作为私有地址。

--------

**2\. B类地址：**

128.0.0.0－191.255.255.255
(**10**000000 00000000 00000000 00000000 ~ **10**111111 11111111 11111111 11111111)
ip地址前两位为10，前16位为网络号，标识网段，后16位为主机号，标识主机。

B类私有地址(同时也是保留地址)
    172.16.0.0－172.31.255.255

B类一段已指定用途、稍微特殊点的地址（但可无视此特殊性）
    169.254.0.0－169.254.255.255，用于使用DHCP协议的主机，当出现某种错误导致无法分配地址时，就自动随机生成一个在此范围地址。

**3\. C类地址：**

192.0.0.0 - 223.255.255.255
(**110**00000 00000000 00000000 00000000 ~ **110**11111 11111111 11111111 11111111)
ip地址前三位为110，前24位为网络号，后8位为主机号。
C类私有地址(同时也是保留地址)
    192.168.0.0－192.168.255.255

----

前三类是网络划分的重点，后面两类使用较少。

**4\. D类地址：**

组播(多播)地址，ip前四位为 1110 ，224.0.0.0～239.255.255.255
(**1110**0000 00000000 00000000 00000000 ~ **1110**1111 11111111 11111111 11111111)
组播地址前4位固定位**1110**，可变化的有28位，故组播地址有2^28个。  

硬件(MAC)组播：即把多播ip地址转为硬件组播MAC地址交付给局域网内的组播组成员。以太网硬件组播地址范围是01:00:5E:00:00:00 ~ 01:00:5E:7F:FF:FF(十六进制)

前25位为0000 0001 : 0000 0000 : 0101 1110 : 0
后23位可供分配地址0000000 : 00000000 : 00000000到1111111 : 11111111 : 11111111。硬件组播MAC地址后23位直接映射ip组播地址的后23位，故组播ip地址和硬件MAC地址不是一一映射(D类ip地址可变位有28位)。因此主机收到数据链路层的组播数据报，需要由ip层进行过滤可能不属于本主机的数据报。例如主机在收听组播频道224.0.64.32，但在数据链路层由于ip地址224.128.64.32对应的组播MAC地址相同，因此也可能会收到224.128.64.32的数据报，需要在网络层根据ip过滤。

**5\. E类地址：**

ip地址前四位为1111,地址保留至今，未使用。
(**1111**0000 00000000 00000000 00000000 - **1111**1111 11111111 11111111 11111111)
网络号全1:主机号全1,即255.255.255.255表示受限(有限/本地)广播。
一般用于当主机还不知道自己的ip或者子网掩码时，使用此地址进行广播通信，请求DHCP分配地址。

DHCP请求过程：
  1）广播DHCP服务器发现报文 
  2）DHCP服务器应答，广播 DHCP提供报文 
  3）主机接受DHCP服务器给的配置，广播DHCP请求报文 （广播的目的表明自己接受了谁的DHCP应答，存在多个DHCP服务器时，其他服务器可以得知自己提供的ip并没有被采纳）
  4）DHCP服务器广播DHCP确认信息。

**6\. 私有地址：**

私有地址只能用于局域网，不用于广域网，即不能直接用于和Internet通信。通信需要通过网关利用nat协议将私有地址转为公网地址，私有地址目的是用于保护内部网络，是出于网络安全考虑的。该概念ipv6依然保留，私有网络方便个人建立自己的个人网络，无需向网络供应商申请ip，就可以对内部提供各种服务。当不想和Internet连接，只希望内部访问时使用私有地址。

**其实和保留地址基本相同**

7\. 保留地址：包括所有私有地址，同时又增加100网段下的一段地址，保留地址的目的应该出于缓解ipv4地址紧缺。由于保留地址(包括私有地址)不会出现在Internet上，这些地址不用来标识Internet上唯一的主机，而能用来标识本地网络上的唯一一台主机。因此可用于和本地的主机通信。当这台主机不需要和Internet通信时，就可以分配保留地址(私网地址)。这一设定，使得同一个保留地址，所有人都能使用，可极大的缓解ipv4地址紧缺。

而且事实上用保留地址的主机也可以通过一定方式和Internet通信，当需要与Internet上的主机通信时，通过网关的nat协议将保留地址转为公网地址即可。保留地址类似老大老二这种称呼，虽然每家都有老大老二，但在自己家老大老二能标识唯一一个人，而且这个称呼只在自己家用。家里面就户主有名字，当老大老二想和外人交流时，就把内容告诉户主，户主去交流，同时户主收到别人告诉自己的信息，会判断是否是给老大老二的，如果是就转告给老大老二，当然这个判断并不难实现，但并非单纯网络层能解决，此处不在细谈。