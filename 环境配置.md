## 环境配置

### 1. 安装Node.js

- 中文官网：[下载 | Node.js 中文网](https://nodejs.cn/download/)

- 英文官网：[Node.js — 下载 Node.js®](https://nodejs.org/zh-cn/download/)


- 文档：https://hexo.io/zh-cn/docs/

Linux:

```bash
# 下载并安装 nvm：
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

# 代替重启 shell
\. "$HOME/.nvm/nvm.sh"

# 下载并安装 Node.js：
nvm install 24

# 验证 Node.js 版本：
node -v # Should print "v24.13.0".

# 验证 npm 版本：
npm -v # Should print "11.6.2".
```

- 更改国内源:
```bash
npm config set registry https://registry.npmmirror.com
```

- 安装cnpm
```bash
npm install -g cnpm --registry=https://registry.npmmirror.com
# 查看是否安装成功
cnpm -v
# 查看安装路径
npm root -g
# 添加PATH环境变量路径
%USERPROFILE%\AppData\Roaming\npm
```

> 说明:
> -g参数: 用于全局安装, 可以在任何地方使用该命令, 不添加-g参数则安装在当前目录下, 且无法使用命令行访问
> -registry参数: 指定npm的源

### 2. 安装Hexo

- 安装Hexo
```bash
cnpm install -g hexo-cli

cnpm install hexo  # 相当于 `hexo init .`
# hexo相关依赖
cnpm install hexo-deployer-git hexo-server hexo-filter-mathjax hexo-util moment-timezone --save
cnpm install hexo-generator-archive hexo-generator-category hexo-generator-index hexo-generator-tag hexo-renderer-ejs --save
```

### 3. 安装主题

推荐主题: butterfly
- 主题：https://github.com/jerryc127/hexo-theme-butterfly
- 官网：https://butterfly.js.org/posts/21cfbf15/
- 下载:
```bash
git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly
```
- 主题其他依赖
```bash
# --save命令将包依赖保存到当前目录的package.json中
# 主题相关依赖
cnpm install hexo-renderer-pug hexo-renderer-stylus --save

# 渲染相关依赖
# markdown支持
cnpm install hexo-renderer-markdown-it --save
# katex支持
cnpm install katex @renbaoshuo/markdown-it-katex --save
```

### 5. 配置

- 配置 hexo 根目录的配置文件
```yaml
# 参考https://github.com/jerryc127/hexo-theme-butterfly/issues/1693
# 确保 markdown-it-katex 插件被启用
markdown:
  plugins:
    - '@renbaoshuo/markdown-it-katex'
```

- _config.butterfly.yml配置文件
```yaml
math:
  use: katex
  per_page: true
  katex:
    # Enable the copy KaTeX formula
    copy_tex: true
    css: https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css
    js: https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js
    copy_css: true
    mhchem:
      enable: false
      js: https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/mhchem.min.js
```

### 最终所有的包：
```
npm ls --depth 0
hexo-site@0.0.0 D:\OneDrive\blog
├── hexo-filter-mathjax@0.9.1
├── hexo-generator-archive@2.0.0
├── hexo-generator-category@2.0.0
├── hexo-generator-index@3.0.0
├── hexo-generator-tag@2.0.0
├── hexo-renderer-ejs@2.0.0
├── hexo-renderer-pandoc@0.5.0
├── hexo-renderer-pug@3.0.0
├── hexo-renderer-stylus@3.0.1
├── hexo-server@3.0.0
└── hexo@7.3.0
```

### hexo常用命令

- 初始化Hexo
```bash
hexo init
```
- 安装依赖
```bash
cnpm install
```
- 生成静态文件
```bash
hexo generate
```
- 清除缓存
```bash
hexo clean
```
- 启动Hexo
```bash
hexo server
```
- 部署到GitHub Pages
```bash
hexo deploy
```
